
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TSLSA | Licensed Surveyors Association Portal</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .brand-green { background-color: #166534; } /* Professional Dark Green */
        .brand-accent { background-color: #fbbf24; } /* Gold Accent */
        
        @media print {
            body * { visibility: hidden; }
            #printSection, #printSection * { visibility: visible; }
            #printSection { position: absolute; left: 0; top: 0; width: 100%; display: block !important; border: none !important; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>

    <div class="bg-white border-b border-gray-200 py-2 px-4 flex justify-between items-center text-[10px] font-bold text-gray-400 uppercase tracking-widest">
        <span>TSLSA Professional Directory</span>
        <span>Verification System v2.0</span>
    </div>

    <nav class="brand-green text-white shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 h-20 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="bg-white p-2 rounded-lg w-12 h-12 flex items-center justify-center shadow-inner">
                    <i class="fas fa-map-marked-alt text-green-800 text-2xl"></i>
                </div>
                <div>
                    <h1 class="text-xl font-extrabold leading-none tracking-tight">TSLSA</h1>
                    <p class="text-[10px] uppercase opacity-80 font-semibold tracking-tighter">Telangana State Licensed Surveyors Association</p>
                </div>
            </div>
            <div class="hidden md:flex gap-8 text-xs font-bold uppercase tracking-widest">
                <a href="#" class="hover:text-yellow-400 transition">Directory</a>
                <a href="#" class="hover:text-yellow-400 transition">About Us</a>
                <button class="brand-accent text-green-900 px-4 py-2 rounded font-black hover:bg-yellow-300 transition shadow-md">Member Login</button>
            </div>
        </div>
    </nav>

    <header class="bg-white border-b py-10 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="text-center md:text-left">
                <h2 class="text-3xl font-black text-slate-800 tracking-tight">Surveyor Authenticity Portal</h2>
                <p class="text-slate-500 text-sm mt-1 uppercase font-semibold tracking-wide">Public Member Verification & Credentialing Service</p>
            </div>
            <div id="verifyStatus" class="hidden bg-green-50 border-2 border-green-500 px-6 py-3 rounded-2xl flex items-center gap-4">
                <div class="w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center animate-bounce">
                    <i class="fas fa-check"></i>
                </div>
                <div>
                    <p class="text-[10px] font-black text-green-600 uppercase">Status</p>
                    <p class="text-sm font-bold text-green-900">Official Profile Verified</p>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <div class="bg-white p-6 rounded-2xl shadow-xl border border-slate-100 mb-8 -mt-16 relative z-10">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="md:col-span-2 relative">
                    <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="searchInput" onkeyup="filterData()" placeholder="Enter Member Name, ID, or Phone..." class="w-full pl-12 pr-4 py-4 bg-slate-50 border-2 border-slate-200 rounded-xl outline-none focus:border-green-600 transition">
                </div>
                <select id="distFilter" onchange="filterData()" class="p-4 bg-slate-50 border-2 border-slate-200 rounded-xl font-bold text-slate-600 outline-none appearance-none">
                    <option value="">All Districts</option>
                    <option value="Nizamabad">Nizamabad</option>
                    <option value="Hyderabad">Hyderabad</option>
                    <option value="Warangal">Warangal</option>
                </select>
                <button onclick="exportCSV()" class="bg-slate-800 hover:bg-black text-white font-bold rounded-xl py-4 flex items-center justify-center gap-3 transition shadow-lg">
                    <i class="fas fa-file-excel"></i> Export Directory
                </button>
            </div>
        </div>

        <div class="bg-white rounded-2xl shadow-2xl border border-slate-100 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-slate-200 text-[11px] font-black text-slate-400 uppercase tracking-widest">
                        <tr>
                            <th class="px-8 py-5">License ID</th>
                            <th class="px-8 py-5">Professional Details</th>
                            <th class="px-8 py-5 hidden md:table-cell">Area of Jurisdiction</th>
                            <th class="px-8 py-5 text-center">Membership</th>
                            <th class="px-8 py-5 text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable" class="divide-y divide-slate-100 text-sm">
                        <tr><td colspan="5" class="p-24 text-center text-slate-400 italic font-medium">Syncing with Association Database...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <footer class="bg-slate-900 text-slate-400 py-16 mt-12">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-12">
            <div class="space-y-4">
                <h3 class="text-white font-bold uppercase tracking-widest text-sm">About TSLSA</h3>
                <p class="text-xs leading-relaxed">The Telangana State Licensed Surveyors Association is a professional body dedicated to maintaining standards and integrity in land surveying across Telangana.</p>
            </div>
            <div class="space-y-4">
                <h3 class="text-white font-bold uppercase tracking-widest text-sm">Legal Disclaimer</h3>
                <p class="text-[10px] leading-relaxed italic">This portal is for member verification only. It is not an official government record. For legal land disputes, please consult the Revenue Department directly. TSLSA is not liable for data entry errors.</p>
            </div>
            <div class="space-y-4">
                <h3 class="text-white font-bold uppercase tracking-widest text-sm">Contact Admin</h3>
                <p class="text-xs">Office: Nizamabad / Hyderabad, Telangana</p>
                <div class="flex gap-4 text-lg">
                    <i class="fab fa-whatsapp hover:text-green-500 cursor-pointer"></i>
                    <i class="fas fa-envelope hover:text-blue-400 cursor-pointer"></i>
                </div>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-4 mt-12 pt-8 border-t border-slate-800 text-center text-[10px] font-bold uppercase tracking-widest">
            &copy; 2025 TSLSA Professional Body. Developed for Digital Transparency.
        </div>
    </footer>

    <div id="printSection" class="hidden p-12 bg-white border-[20px] border-double border-green-900">
        <div class="text-center border-b-4 border-green-900 pb-8 mb-10">
            <h1 class="text-3xl font-black text-green-900 tracking-tighter uppercase">Member Verification Certificate</h1>
            <p class="text-sm font-bold text-slate-500 uppercase tracking-[0.4em] mt-2">Telangana State Licensed Surveyors Association</p>
        </div>
        <div class="grid grid-cols-3 gap-10">
            <div class="col-span-2 space-y-8">
                <div>
                    <p class="text-xs font-black text-slate-300 uppercase">Licensed Professional</p>
                    <h2 id="pName" class="text-5xl font-black text-slate-900 uppercase tracking-tighter"></h2>
                </div>
                <div class="grid grid-cols-2 gap-6 pt-6 border-t border-slate-100">
                    <div>
                        <p class="text-[10px] font-black text-slate-300 uppercase">License ID No.</p>
                        <p id="pID" class="text-2xl font-mono font-bold text-green-800"></p>
                    </div>
                    <div>
                        <p class="text-[10px] font-black text-slate-300 uppercase">Status</p>
                        <p class="text-xl font-bold text-green-600">‚óè ACTIVE MEMBER</p>
                    </div>
                </div>
                <div class="pt-6 border-t border-slate-100">
                    <p class="text-[10px] font-black text-slate-300 uppercase">Jurisdiction</p>
                    <p class="text-lg font-bold text-slate-700 uppercase"><span id="pMandal"></span>, <span id="pDist"></span></p>
                </div>
            </div>
            <div class="flex flex-col items-center justify-center border-2 border-slate-100 rounded-3xl p-6 bg-slate-50">
                <div id="qrcode"></div>
                <p class="text-[10px] font-black text-green-900 mt-6 text-center uppercase leading-tight">Secure Digital<br>Authentication QR</p>
            </div>
        </div>
        <div class="mt-20 flex justify-between items-end">
            <div class="text-center">
                <div class="w-48 border-b-2 border-slate-300 mb-2"></div>
                <p class="text-xs font-black text-slate-400 uppercase">Official TSLSA Seal</p>
            </div>
            <p class="text-xs text-slate-400 font-bold">Generated: <span id="pDate"></span></p>
        </div>
    </div>

    <script>
        let rawData = [];
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/1GTQ3JvpM3f6VeEvAjFzQtXAFSwXSU-M8ZAuBRrUuic8/export?format=csv';

        async function init() {
            try {
                const res = await fetch(CSV_URL);
                const text = await res.text();
                const rows = text.split('\n').slice(1);
                rawData = rows.map(row => {
                    const c = row.split(',');
                    return { id: c[0]?.trim(), name: c[1]?.trim(), dist: c[2]?.trim(), mandal: c[3]?.trim(), status: c[4]?.trim(), phone: c[5]?.trim() };
                }).filter(r => r.id && r.name && r.name !== 'not mentioned');

                const urlId = new URLSearchParams(window.location.search).get('id');
                if(urlId) {
                    document.getElementById('verifyStatus').classList.remove('hidden');
                    render(rawData.filter(x => x.id === urlId));
                } else { render(rawData); }
            } catch(e) {
                document.getElementById('dataTable').innerHTML = `<tr><td colspan="5" class="p-20 text-center text-red-500 font-bold">Failed to connect to central database.</td></tr>`;
            }
        }

        function render(data) {
            const table = document.getElementById('dataTable');
            if(data.length === 0) { table.innerHTML = '<tr><td colspan="5" class="p-20 text-center text-slate-300 font-bold">No matching records found.</td></tr>'; return; }

            table.innerHTML = data.map(s => `
                <tr class="hover:bg-slate-50 transition border-b border-slate-50">
                    <td class="px-8 py-6 font-mono font-bold text-green-700">${s.id}</td>
                    <td class="px-8 py-6">
                        <div class="font-black text-slate-800 text-base uppercase">${s.name}</div>
                        <div class="text-[10px] text-slate-400 font-bold mt-1 uppercase"><i class="fas fa-phone mr-1"></i> ${s.phone || 'Private'}</div>
                    </td>
                    <td class="px-8 py-6 hidden md:table-cell">
                        <span class="text-slate-700 font-bold uppercase text-xs">${s.mandal}, ${s.dist}</span>
                    </td>
                    <td class="px-8 py-6 text-center">
                        <span class="px-4 py-2 rounded-full text-[10px] font-black uppercase ${s.status === 'Active' ? 'bg-green-100 text-green-700 border border-green-200' : 'bg-red-100 text-red-700 border border-red-200'}">
                            ${s.status}
                        </span>
                    </td>
                    <td class="px-8 py-6 text-right flex justify-end gap-3">
                        <button onclick="doPrint('${s.id}')" class="bg-slate-100 hover:bg-green-800 hover:text-white p-3.5 rounded-xl transition shadow-sm" title="Print Certificate">
                            <i class="fas fa-certificate text-lg"></i>
                        </button>
                        <a href="https://wa.me/91XXXXXXXXXX?text=Reporting%20issue%20with%20ID:%20${s.id}" target="_blank" class="bg-red-50 hover:bg-red-600 hover:text-white text-red-600 p-3.5 rounded-xl transition shadow-sm" title="Report Issue">
                            <i class="fas fa-exclamation-triangle"></i>
                        </a>
                    </td>
                </tr>`).join('');
        }

        function filterData() {
            const q = document.getElementById('searchInput').value.toLowerCase();
            const d = document.getElementById('distFilter').value.toLowerCase();
            const filtered = rawData.filter(s => 
                (s.name.toLowerCase().includes(q) || s.id.toLowerCase().includes(q)) &&
                (d === "" || s.dist.toLowerCase() === d)
            );
            render(filtered);
        }

        function doPrint(id) {
            const s = rawData.find(x => x.id === id);
            document.getElementById('pName').innerText = s.name;
            document.getElementById('pID').innerText = s.id;
            document.getElementById('pMandal').innerText = s.mandal;
            document.getElementById('pDist').innerText = s.dist;
            document.getElementById('pDate').innerText = new Date().toLocaleDateString('en-IN');
            const qr = document.getElementById("qrcode");
            qr.innerHTML = "";
            new QRCode(qr, { text: window.location.href.split('?')[0] + "?id=" + s.id, width: 150, height: 150, colorDark: "#14532d" });
            setTimeout(() => { window.print(); }, 700);
        }

        function exportCSV() {
            let c = "License,Name,District,Mandal,Status,Phone\n" + rawData.map(s => `"${s.id}","${s.name}","${s.dist}","${s.mandal}","${s.status}","${s.phone}"`).join("\n");
            const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([c], { type: 'text/csv' })); a.download = 'TSLSA_Directory.csv'; a.click();
        }

        init();
    </script>
</body>
</html>
